@model thpt.ThachBan.DTO.ViewModels.Areas.Student.AboutStudent
@using Microsoft.AspNetCore.Mvc.Rendering
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<style>
    .form-check:hover {
        background-color: yellowgreen;
    }
</style>
@*<div class="toast bg-white" role="alert" aria-live="assertive" aria-atomic="true" data-delay="2000" style="z-index:100;position: fixed; top: 1rem; right: 1rem;height: 100px">
    <div class="toast-header d-flex justify-content-between">
        <h4>Thông báo</h4>
    </div>
    <div class="toast-body;">
        Cập nhật thông tin thành công
    </div>
</div>*@
<div id="content-wrapper" class="content-main d-flex flex-column">

    <!-- Main Content -->
    <div id="content">
        <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 d-md-none static-top shadow">

            <!-- Sidebar Toggle (Topbar) -->
            <button id="sidebarToggleTop" class="btn btn-link rounded-circle mr-3">
                <i class="fa fa-bars"></i>
            </button>
        </nav>
        <div class="container-fluid">
            <hr />
            <h4 class="mb-4">Thông tin học sinh</h4>
            <hr />
            <table class="table-borderless">
                <tbody>
                    <tr>
                        <td class="col-4 p-0">
                            Mã học sinh
                        </td>
                        <td>
                            <input type="text" id="StudentId" value="@Model.student.StudentId" hidden>
                            <input type="text" disabled class="form-control" id="StudentCode" name="StudentCode" value="@Model.student.StudentCode" placeholder="Nhập mã học sinh">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Họ tên học sinh
                        </td>
                        <td>
                            <input type="text" class="form-control" id="StudentName" name="StudentName" value="@Model.student.StudentName" placeholder="Nhập họ tên học sinh">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label for="Gender">Giới tính</label>
                        </td>
                        <td>
                            @Html.DropDownList("Gender", new SelectList(new Dictionary<int,string>(){ {0,"Nữ"}, {1,"Nam"}}, "Key", "Value", @Model.student.Gender), htmlAttributes: new { @class = "form-control" })

                        </td>
                    </tr>
                    <tr>
                        <td>
                            Ngày sinh

                        </td>
                        <td class="d-flex">
                            <input type="text" style="width: 50px;" class="form-control" id="DateOfBirthDate" name="DateOfBirthDate" value="@Model.student.DateOfBirth.ToString("dd")" placeholder="DD" /><span style="font-size: 28px">/</span>
                            <input type="text" style="width: 50px;" class="form-control" id="DateOfBirthMonth" name="DateOfBirthMonth" value="@Model.student.DateOfBirth.ToString("MM")" placeholder="MM"><span style="font-size: 28px">/</span>
                            <input type="text" style="width: 100px;" class="form-control" id="DateOfBirthYear" name="DateOfBirthYear" value="@Model.student.DateOfBirth.ToString("yyyy")" placeholder="YYYY">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Nơi sinh
                        </td>
                        <td>
                            <input type="text" class="form-control" id="PlaceOfBirth" name="PlaceOfBirth" value="@Model.student.PlaceOfBirth" placeholder="Nhập nơi sinh">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            Dân tộc
                        </td>
                        <td>
                            <input type="text" class="form-control" id="Nation" name="Nation" value="@Model.student.Nation" placeholder="Nhập dân tộc">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Địa chỉ
                        </td>
                        <td>
                            <input type="text" class="form-control" id="Address" name="Address" value="@Model.student.Address" placeholder="Nhập địa chỉ">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Lớp
                        </td>
                        <td>
                            <select class="form-control" data-val="true" data-val-required="The Gender field is required." id="ClassId" name="ClassId">
                                @foreach (var item in (List<thpt.ThachBan.DTO.Models.Class>)TempData["Classes"])
                                {
                                    @if (item.ClassId == Model.student.ClassId)
                                    {
                                        <option selected="selected" value="@item.ClassId">@item.ClassName</option>
                                    }
                                    else
                                    {
                                        <option value="@item.ClassId">@item.ClassName</option>
                                    }
                                }
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Vị trí ngồi
                        </td>
                        <td>
                            <input type="text" disabled class="form-control" id="CodeOfSeat" name="CodeOfSeat" value="@Model.student.CodeOfSeat" placeholder="Vị trí ngồi">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Chức vụ
                        </td>
                        <td>
                            <select class="form-control" data-val="true" data-val-required="The Gender field is required." id="StudentTask" name="StudentTask">
                                @foreach (var item in (List<thpt.ThachBan.DTO.Models.StudentTask>)TempData["StudentTasks"])
                                {
                                    @if (item.StudentTaskId == Model.student.StudentTaskId)
                                    {
                                        <option selected="selected" value="@item.StudentTaskId">@item.StudentTaskName</option>
                                    }
                                    else
                                    {
                                        <option value="@item.StudentTaskId">@item.StudentTaskName</option>
                                    }
                                }
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Học bổng
                        </td>
                        <td>
                            <select class="form-control" data-val="true" data-val-required="The Gender field is required." id="SocialPolicy" name="SocialPolicy">
                                @foreach (var item in (List<thpt.ThachBan.DTO.Models.SocialPolicy>)TempData["SocialPolicys"])
                                {
                                    @if (item.SocialPolicyId == Model.student.SocialPolicyId)
                                    {
                                        <option selected="selected" value="@item.SocialPolicyId">@item.SocialPolicyName</option>
                                    }
                                    else
                                    {
                                        <option value="@item.SocialPolicyId">@item.SocialPolicyName</option>
                                    }
                                }
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Trạng thái
                        </td>
                        <td>
                            @Html.DropDownList("Status", new SelectList(new Dictionary<int,string>(){ {1,"Đang học"}, {0,"Nghỉ học"}}, "Key", "Value", @Model.student.Status), htmlAttributes: new { @class = "form-control" })

                        </td>
                    </tr>
                    <tr>
                        <td>
                            Ngày tạo
                        </td>
                        <td>
                            @Model.student.CreatedDate.ToString("dd/MM/yyyy")
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Người tạo
                        </td>
                        <td>
                            @ViewBag.CreatedBy
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Ngày cập nhật
                        </td>
                        <td>
                            @Model.student.UpdatedDate?.ToString("dd/MM/yyyy")
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Người cập nhật
                        </td>
                        <td>
                            @ViewBag.UpdatedBy
                        </td>
                    </tr>
                </tbody>
            </table>
            <hr />
            <hr />
            <h4 class="mb-4">Thông tin liên hệ</h4>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <td class="col-1 p-0 text-center  p-3"></td>
                        <td class="col-3 p-0 text-center">Mẹ</td>
                        <td class="col-3 p-0 text-center">Cha</td>
                        <td class="col-2 p-0 text-center">Người giám hộ</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td scope="row">
                            Họ tên
                        </td>
                        <td>
                            <input type="text" hidden id="motherId" value="@Model.mother.GuardianId">
                            <input type="text" hidden id="fatherId" value="@Model.father.GuardianId">
                            <input type="text" hidden id="otherId" value="@Model.other.GuardianId">
                            <input type="text" class="form-control" id="MotherGuardianName" name="MotherGuardianName" value="@Model.mother.GuardianName" placeholder="Họ tên mẹ">
                        </td>
                        <td>
                            <input type="text" class="form-control" id="FatherGuardianName" name="FatherGuardianName" value="@Model.father.GuardianName" placeholder="Họ tên cha">
                        </td>
                        <td>
                            <input type="text" class="form-control" id="OtherGuardianName" name="OtherGuardianName" value="@Model.other.GuardianName" placeholder="Họ tên giám hộ">
                        </td>
                    </tr>
                    <tr>
                        <td scope="row">
                            Nghề nghiệp
                        </td>
                        <td>
                            <input type="text" class="form-control" id="MotherCareer" name="MotherCareer" value="@Model.mother.Career" placeholder="Nghề nghiệp mẹ">
                        </td>
                        <td>
                            <input type="text" class="form-control" id="FatherCareer" name="FatherCareer" value="@Model.father.Career" placeholder="Nghề nghiệp cha">

                        </td>
                        <td>
                            <input type="text" class="form-control" id="OtherCareer" name="OtherCareer" value="@Model.other.Career" placeholder="Nghề nghiệp giám hộ">

                        </td>
                    </tr>
                    <tr>
                        <td scope="row">
                            Số điện thoại
                        </td>
                        <td>
                            <input type="text" class="form-control" id="MotherPhoneNumber" name="MotherPhoneNumber" value="@Model.mother.PhoneNumber" placeholder="SĐT mẹ">
                        </td>
                        <td>
                            <input type="text" class="form-control" id="FatherPhoneNumber" name="FatherPhoneNumber" value="@Model.father.PhoneNumber" placeholder="SĐT cha">
                        </td>
                        <td>
                            <input type="text" class="form-control" id="OtherPhoneNumber" name="OtherPhoneNumber" value="@Model.other.PhoneNumber" placeholder="SĐT giám hộ">
                        </td>
                    </tr>
                    <tr>
                        <td scope="row">
                            Email
                        </td>
                        <td>
                            <input type="text" class="form-control" id="MotherEmail" name="MotherEmail" value="@Model.mother.Email" placeholder="Email mẹ">
                        </td>
                        <td>
                            <input type="text" class="form-control" id="FatherEmail" name="FatherEmail" value="@Model.father.Email" placeholder="Email cha">
                        </td>
                        <td>
                            <input type="text" class="form-control" id="OtherEmail" name="OtherEmail" value="@Model.other.Email" placeholder="Email giám hộ">
                        </td>
                    </tr>
                    <tr>
                        <td scope="row">
                            
                        </td>
                        <td class="text-center">
                            <input type="button" class="btn btn-danger" id="MotherInfor" value="Xóa" >
                        </td>
                        <td class="text-center">
                            <input type="button" class="btn btn-danger" id="FatherInfor" value="Xóa">
                        </td>
                        <td class="text-center">
                            <input type="button" class="btn btn-danger" id="OtherInfor" value="Xóa">
                        </td>
                    </tr>
                </tbody>
            </table>
        <hr />
        <div class="d-flex justify-content-center">
            <button class="btn btn-success" id="submitData">Lưu</button>
            <span style="width: 50px;"></span>
            <a href="/Admin/TeacherManager" class="btn btn-secondary" id="comeback">Quay lại </a>
        </div>
        </div>
    </div>
</div>
<script>

    $(document).ready(function () {
        $('#submitData').on("click", function () {
            console.log($('#ClassId').val());
            var datapost = {
                StudentId: $('#StudentId').val(),
                StudentCode: $('#StudentCode').val(),
                StudentName: $('#StudentName').val(),
                Gender: $('#Gender').val(),
                DateOfBirthDate: $('#DateOfBirthDate').val(),
                DateOfBirthMonth: $('#DateOfBirthMonth').val(),
                DateOfBirthYear: $('#DateOfBirthYear').val(),
                PlaceOfBirth: $('#PlaceOfBirth').val(),
                Nation: $('#Nation').val(),
                Address: $('#Address').val(),
                Class: $('#ClassId').val(),
                StudentTask: $('#StudentTask').val(),
                SocialPolicy: $('#SocialPolicy').val(),
                Status: $('#Status').val(),
                mother: {
                    GuardianId: $('#motherId').val(),
                    GuardianName: $('#MotherGuardianName').val(),
                    Career: $('#MotherCareer').val(),
                    PhoneNumber: $('#MotherPhoneNumber').val(),
                    Email: $('#MotherEmail').val(),
                },
                father:{
                    GuardianId: $('#fatherId').val(),
                    GuardianName: $('#FatherGuardianName').val(),
                    Career: $('#FatherCareer').val(),
                    PhoneNumber: $('#FatherPhoneNumber').val(),
                    Email: $('#FatherEmail').val(),
                },
                other: {
                    GuardianId: $('#otherId').val(),
                    GuardianName: $('#OtherGuardianName').val(),
                    Career: $('#OtherCareer').val(),
                    PhoneNumber: $('#OtherPhoneNumber').val(),
                    Email: $('#OtherEmail').val(),
                }
            };
            console.log(JSON.stringify(datapost));
            const data = $.ajax({
                url: '@Url.Action("EditStudent","StudentManager")',
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(datapost),
                success: function (data) {
                    //var toast = document.querySelector(".toast");
                    //// Thêm lớp "show" để hiển thị thông báo
                    //toast.classList.add("show");
                    //setTimeout(removeToastClass, 5000);
                    if (data.status == 200) {
                        alert("Cập nhật thông tin thành công!");
                    }
                    else if (data.status == 501) {
                        alert(data.message);
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log('Error creating employee: ' + textStatus);
                }
            });
        })
        $('#MotherInfor').click(function () {
            $('#MotherGuardianName').val('');
            $('#MotherCareer').val('');
            $('#MotherPhoneNumber').val('');
            $('#MotherEmail').val('');
        });
        $('#FatherInfor').click(function () {
            $('#FatherGuardianName').val('');
            $('#FatherCareer').val('');
            $('#FatherPhoneNumber').val('');
            $('#FatherEmail').val('');
        });
        $('#OtherInfor').click(function () {
            $('#OtherGuardianName').val('');
            $('#OtherCareer').val('');
            $('#OtherPhoneNumber').val('');
            $('#OtherEmail').val('');
        });

    });


</script>

